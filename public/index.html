<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Doğrulama Sayfası</title>
  <style>
    .flex-container {
      display: flex;
      flex-wrap: wrap;
      /* Satır taşarsa yeni satıra geçmesini sağlar */
      gap: 20px;
      /* Projeler arasında boşluk bırakır */
    }

    .project {
      background-color: #f4f4f4;
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 8px;
      width: 200px;
      /* Her bir projenin genişliği */
    }

    .project h3 {
      margin-top: 0;
    }

    body {
      font-family: Arial, sans-serif;
      background-color: #f4f4f9;
      margin: 0;
      padding: 0;
    }

    .container {
      max-width: 800px;
      margin: 50px auto;
      padding: 20px;
      background-color: #ffffff;
      border-radius: 10px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      text-align: center;
    }

    .hidden {
      display: none;
    }

    h1 {
      color: #333;
    }

    .button {
      display: inline-block;
      margin: 10px 0;
      padding: 12px 20px;
      color: white;
      background-color: #007bff;
      border: none;
      border-radius: 5px;
      text-decoration: none;
      font-size: 16px;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }

    .button:hover {
      background-color: #0056b3;
    }

    .twitter-button {
      background-color: #1da1f2;
    }

    .twitter-button:hover {
      background-color: #1a91da;
    }

    #logout-button {
      background-color: #dc3545;
    }

    #logout-button:hover {
      background-color: #c82333;
    }

    .invite-list h2 {
      color: #555;
      margin-bottom: 10px;
    }

    #invites-container {
      background-color: #f0f0f0;
      padding: 15px;
      border-radius: 5px;
      box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1);
    }

    #verification-container {
      margin-top: 20px;
    }

    .verification-button {
      display: inline-block;
      margin-top: 10px;
      padding: 10px 20px;
      background-color: #28a745;
      color: white;
      border-radius: 5px;
      cursor: pointer;
    }

    .verification-button:hover {
      background-color: #218838;
    }
  </style>
  <!-- <link rel="stylesheet" href="/public/index.css"> -->
</head>


<body>
  <div class="container">



    <div class="social-buttons">
      <button id="twitter-button" class="twitter-button" onclick="startTwitterConnect()">Twitter Bağla</button>
    </div>


  </div>
  <script>
    // function parseJwt(token) {
    //   console.log(token);
    //   if (!token) {
    //     throw new Error("Geçersiz token: Token boş veya null.");
    //   }
    //   // Token'ı '.' ile ayır ve ikinci parçayı (Payload) al
    //   const base64Url = token.split('.')[1];

    //   // Base64 formatına uygun hale getir
    //   const base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');

    //   // Base64'ten çözümlenmiş JSON verisini al
    //   const jsonPayload = decodeURIComponent(atob(base64).split('').map(c => {
    //     return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);
    //   }).join(''));

    //   // JSON formatında döndür
    //   return JSON.parse(jsonPayload);
    // }
    // document.addEventListener('DOMContentLoaded', function () {
    //   // localStorage'dan token'ı al

    //   const token = localStorage.getItem('bearerToken');


    //   const decodedToken = parseJwt(token);
    //   if (token) {
    //     // Token'ı çözümle
    //     alert(decodedToken);
    //     // Kullanıcı adını sayfada göster
    //     // document.getElementById('username').textContent = decodedToken.username;

    //   } else {
    //     const urlParams = new URLSearchParams(window.location.search);
    //     const token = urlParams.get('token');
    //     if (token) {
    //       localStorage.setItem('bearerToken', token);
    //     } else {
    //       alert('Lütfen giriş yapın.');
    //       // window.location.href = '/index.html';
    //     }
    //   }
    // });
    async function startTwitterConnect() {
  const authUrl = `/twitter/authorizeUrl`;
  try {
    const response = await fetch(authUrl, {
      method: 'GET',
      headers: {
        'Content-Type': 'application/json'
      }
    });

    if (!response.ok) {
      const errorText = await response.text(); // Hata metnini al
      throw new Error(`API isteği başarısız: ${response.status} - ${errorText}`);
    }

    const data = await response.json();

    // Yanıt türünü kontrol et
    if (typeof data === 'string') {
      alert(data);
      // localStorage.setItem('bearerToken', data);
      // window.location = '../home/managerHome.html';
    } else {
      document.getElementById('login-error-message').innerText = 'Login failed: ' + (data.error || 'Unknown error');
    }
  } catch (error) {
    console.error('Hata oluştu:', error);
    document.getElementById('login-error-message').innerText = 'Bir hata oluştu: ' + error.message;
  }
}

  </script>
</body>

</html>